<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<AnchorPane prefHeight="491.0" prefWidth="756.0" style="-fx-background-color: linear-gradient(from 0% 0% to 100% 0%, #FFFFFF, #63DBF3);" xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.example.ismoney.controller.BudgetController">
    <children>
        <!-- Header Section -->
        <VBox layoutX="0.0" layoutY="0.0" prefWidth="756.0" spacing="8.0" style="-fx-padding: 15;">
            <!-- App Title and Navigation -->
            <HBox alignment="CENTER_LEFT" spacing="15.0">
                <Label text="IsMoney" style="-fx-font-family: Poppins; -fx-font-weight: Bold; -fx-font-size: 20;" textFill="#9c008c" />
                <Region HBox.hgrow="ALWAYS" />
                <Label text="Manajemen Anggaran" style="-fx-font-family: Poppins; -fx-font-weight: Bold; -fx-font-size: 16;" textFill="#5c5d5e" />
                <Button fx:id="addBudgetBtn" onAction="#handleAddBudget" prefHeight="25.0" prefWidth="100.0"
                        style="-fx-background-color: #9c008c; -fx-font-family: Poppins; -fx-font-weight: Bold; -fx-cursor: hand; -fx-background-radius: 7;"
                        text="Tambah" textFill="WHITE">
                    <font>
                        <Font size="10.0" />
                    </font>
                </Button>
            </HBox>

            <!-- Summary Cards - Optimized Size -->
            <HBox alignment="CENTER" spacing="8.0" style="-fx-padding: 5 0 0 0;">
                <VBox alignment="CENTER" spacing="2.0" style="-fx-background-color: rgba(217, 217, 217, 0.6); -fx-padding: 8; -fx-background-radius: 8; -fx-min-width: 90; -fx-max-width: 90;">
                    <Label text="Total Anggaran" style="-fx-font-family: Poppins; -fx-font-weight: bold; -fx-font-size: 9;" textFill="#5c5d5e" />
                    <Label fx:id="totalBudgetLabel" text="Rp 0" style="-fx-font-family: Poppins; -fx-font-size: 11; -fx-font-weight: bold; -fx-text-fill: #3aa2e9;" />
                </VBox>
                <VBox alignment="CENTER" spacing="2.0" style="-fx-background-color: rgba(217, 217, 217, 0.6); -fx-padding: 8; -fx-background-radius: 8; -fx-min-width: 90; -fx-max-width: 90;">
                    <Label text="Total Digunakan" style="-fx-font-family: Poppins; -fx-font-weight: bold; -fx-font-size: 9;" textFill="#5c5d5e" />
                    <Label fx:id="totalSpentLabel" text="Rp 0" style="-fx-font-family: Poppins; -fx-font-size: 11; -fx-font-weight: bold; -fx-text-fill: #9c008c;" />
                </VBox>
                <VBox alignment="CENTER" spacing="2.0" style="-fx-background-color: rgba(217, 217, 217, 0.6); -fx-padding: 8; -fx-background-radius: 8; -fx-min-width: 90; -fx-max-width: 90;">
                    <Label text="Sisa Anggaran" style="-fx-font-family: Poppins; -fx-font-weight: bold; -fx-font-size: 9;" textFill="#5c5d5e" />
                    <Label fx:id="remainingBudgetLabel" text="Rp 0" style="-fx-font-family: Poppins; -fx-font-size: 11; -fx-font-weight: bold; -fx-text-fill: #0f76dc;" />
                </VBox>
            </HBox>
        </VBox>

        <!-- Main Content Area -->
        <HBox layoutX="15.0" layoutY="110.0" prefHeight="330.0" prefWidth="726.0" spacing="10.0">
            <!-- Left side - Table and Filters -->
            <VBox spacing="8.0" prefWidth="450.0">
                <!-- Filters -->
                <HBox alignment="CENTER_LEFT" spacing="10.0" style="-fx-background-color: rgba(255, 255, 255, 0.9); -fx-padding: 8; -fx-background-radius: 5;">
                    <Label text="Filter:" style="-fx-font-family: Poppins; -fx-font-weight: bold; -fx-font-size: 10;" textFill="#5c5d5e" />
                    <Label text="Periode:" style="-fx-font-family: Poppins; -fx-font-size: 10;" textFill="#5c5d5e" />
                    <ComboBox fx:id="filterPeriodBox" prefWidth="90.0" prefHeight="20.0" style="-fx-background-color: rgba(217, 217, 217, 0.8); -fx-background-radius: 5; -fx-font-family: Poppins; -fx-font-size: 9;" />
                    <CheckBox fx:id="showActiveOnlyBox" text="Hanya Aktif" style="-fx-font-family: Poppins; -fx-font-size: 9;" textFill="#5c5d5e" />
                </HBox>

                <!-- Budget Table -->
                <TableView fx:id="budgetTable" prefHeight="280.0" style="-fx-background-color: rgba(255, 255, 255, 0.9); -fx-background-radius: 5;">
                    <columns>
                        <TableColumn fx:id="categoryColumn" prefWidth="80.0" text="Kategori" style="-fx-font-family: Poppins; -fx-font-size: 9;" />
                        <TableColumn fx:id="limitColumn" prefWidth="70.0" text="Batas" style="-fx-font-family: Poppins; -fx-font-size: 9;" />
                        <TableColumn fx:id="spentColumn" prefWidth="70.0" text="Terpakai" style="-fx-font-family: Poppins; -fx-font-size: 9;" />
                        <TableColumn fx:id="remainingColumn" prefWidth="70.0" text="Sisa" style="-fx-font-family: Poppins; -fx-font-size: 9;" />
                        <TableColumn fx:id="periodColumn" prefWidth="60.0" text="Periode" style="-fx-font-family: Poppins; -fx-font-size: 9;" />
                        <TableColumn fx:id="statusColumn" prefWidth="80.0" text="Status" style="-fx-font-family: Poppins; -fx-font-size: 9;" />
                        <TableColumn fx:id="actionColumn" prefWidth="100.0" text="Aksi" style="-fx-font-family: Poppins; -fx-font-size: 9;" />
                    </columns>
                    <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                    </columnResizePolicy>
                </TableView>
            </VBox>

            <!-- Right side - Chart -->
            <VBox spacing="8.0" prefWidth="266.0">
                <Label text="Grafik Penggunaan Anggaran" style="-fx-font-family: Poppins; -fx-font-size: 12; -fx-font-weight: bold;" textFill="#5c5d5e" />
                <PieChart fx:id="budgetChart" prefHeight="200.0" style="-fx-background-color: rgba(255, 255, 255, 0.9); -fx-background-radius: 5;" />

                <!-- Chart Legend/Info -->
                <VBox spacing="3.0" style="-fx-background-color: rgba(255, 255, 255, 0.9); -fx-padding: 8; -fx-background-radius: 5;">
                    <Label text="Keterangan:" style="-fx-font-family: Poppins; -fx-font-weight: bold; -fx-font-size: 10;" textFill="#5c5d5e" />
                    <HBox spacing="8.0">
                        <Label text="●" style="-fx-text-fill: #9c008c; -fx-font-size: 12;" />
                        <Label text="Melebihi Anggaran" style="-fx-font-family: Poppins; -fx-font-size: 9;" textFill="#5c5d5e" />
                    </HBox>
                    <HBox spacing="8.0">
                        <Label text="●" style="-fx-text-fill: #3aa2e9; -fx-font-size: 12;" />
                        <Label text="Mendekati Batas (70%+)" style="-fx-font-family: Poppins; -fx-font-size: 9;" textFill="#5c5d5e" />
                    </HBox>
                    <HBox spacing="8.0">
                        <Label text="●" style="-fx-text-fill: #0f76dc; -fx-font-size: 12;" />
                        <Label text="Sehat" style="-fx-font-family: Poppins; -fx-font-size: 9;" textFill="#5c5d5e" />
                    </HBox>
                </VBox>
            </VBox>
        </HBox>

        <!-- Footer -->
        <HBox layoutX="15.0" layoutY="450.0" prefWidth="726.0" alignment="CENTER_LEFT" spacing="8.0" style="-fx-background-color: rgba(255, 255, 255, 0.7); -fx-padding: 8; -fx-background-radius: 5;">
            <Label text="Status Anggaran:" style="-fx-font-family: Poppins; -fx-font-weight: bold; -fx-font-size: 9;" textFill="#5c5d5e" />
            <Label text="Anggaran aktif disorot berdasarkan persentase penggunaan" style="-fx-font-family: Poppins; -fx-font-style: italic; -fx-font-size: 8;" textFill="#5c5d5e" />
        </HBox>
    </children>
</AnchorPane>